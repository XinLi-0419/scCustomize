<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scCustomize">
<title>Read &amp; Write Data Functions • scCustomize</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read &amp; Write Data Functions">
<meta property="og:description" content="scCustomize">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scCustomize</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.1.0004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Getting Started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Installation.html">Install</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <h6 class="dropdown-header" data-toc-skip>Plotting Vignettes</h6>
    <a class="dropdown-item" href="../articles/Gene_Expression_Plotting.html">Plotting #1: Analysis Plots</a>
    <a class="dropdown-item" href="../articles/QC_Plots.html">Plotting #2: QC Plots</a>
    <a class="dropdown-item" href="../articles/Sequencing_QC_Plots.html">Plotting #3: Sequencing QC Plots/Analysis</a>
    <a class="dropdown-item" href="../articles/Iterative_Plotting.html">Plotting #4: Iterative Plotting Functions</a>
    <a class="dropdown-item" href="../articles/Color_Palettes.html">Customized Color Palettes &amp; Themes</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Helpers &amp; Utilities</h6>
    <a class="dropdown-item" href="../articles/Read_and_Write_Functions.html">Read &amp; Write Data Functions</a>
    <a class="dropdown-item" href="../articles/Markers_and_Cluster_Annotation.html">Marker Identification &amp; Cluster Annotation Helpers</a>
    <a class="dropdown-item" href="../articles/Statistics.html">Statistics Functions</a>
    <a class="dropdown-item" href="../articles/Helpers_and_Utilities.html">General Helpers &amp; Utilities</a>
    <a class="dropdown-item" href="../articles/Misc_Functions.html">Misc Functions</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Other Package Interactivity/Functions</h6>
    <a class="dropdown-item" href="../articles/LIGER_Functions.html">LIGER Plotting &amp; Functionality</a>
    <a class="dropdown-item" href="../articles/Cell_Bender_Functions.html">Cell Bender Functionality &amp; Plotting</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News/Changelog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/FAQ.html">FAQ</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/samuel-marsh/scCustomize/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Read &amp; Write Data Functions</h1>
            
            <h4 data-toc-skip class="date">Compiled: December 01, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/samuel-marsh/scCustomize/blob/HEAD/vignettes/Read_and_Write_Functions.Rmd" class="external-link"><code>vignettes/Read_and_Write_Functions.Rmd</code></a></small>
      <div class="d-none name"><code>Read_and_Write_Functions.Rmd</code></div>
    </div>

    
    
<hr>
<style>
p.caption {
  font-size: 0.9em;
}
</style>
<div class="section level1">
<h1 id="import-data-functions">Import Data Functions<a class="anchor" aria-label="anchor" href="#import-data-functions"></a>
</h1>
<p>Seurat and other packages provide excellent tools for importing data however when importing large numbers of samples or samples with non-standard names this process can be cumbersome. scCustomize provides number of functions to simplify the process of importing many data sets at the same time and speed up the process using parallelization.</p>
<p>For this tutorial, I will be utilizing several publicly available data sets from NCBI GEO.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/samuel-marsh/scCustomize" class="external-link">scCustomize</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="import-data-from-single-directory">Import Data from Single Directory<a class="anchor" aria-label="anchor" href="#import-data-from-single-directory"></a>
</h2>
<p>Often when downloading files from NCBI GEO or other repos all of the files are contained in single directory and contain non-standard file names. However, functions like <code><a href="https://satijalab.org/seurat/reference/Read10X.html" class="external-link">Seurat::Read10X()</a></code> expect non-prefixed files (i.e. Cell Ranger outputs).</p>
<p>scCustomize has three functions to deal with these situations without need for renaming files.</p>
<div class="section level3">
<h3 id="import-10x-genomics-or-10x-styled-single-directory-with-file-prefixes">Import 10X Genomics (or 10X-styled) single directory with file prefixes<a class="anchor" aria-label="anchor" href="#import-10x-genomics-or-10x-styled-single-directory-with-file-prefixes"></a>
</h3>
<p>The function <code>Read10X_GEO</code> can be used to iteratively read all sets of 10X style files within single directory.</p>
<p>For this example I will be utilizing data from Marsh et al., 2020 (<a href="https://www.biorxiv.org/content/10.1101/2020.12.03.408542v1" class="external-link"><em>bioRxiv</em></a>), which were downloaded from <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE152183" class="external-link">NCBI GEO GSE152183</a></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"assets/GSE152183_RAW_Marsh/"</span><span class="op">)</span>

<span class="va">GEO_10X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read10X_GEO.html">Read10X_GEO</a></span><span class="op">(</span>data_dir <span class="op">=</span> <span class="st">"assets/GSE152183_RAW_Marsh/"</span><span class="op">)</span></code></pre></div>
<div class="section level4">
<h4 id="read10x_geo-additional-parameters">
<code>Read10X_GEO</code> Additional Parameters<a class="anchor" aria-label="anchor" href="#read10x_geo-additional-parameters"></a>
</h4>
<p><code>Read10X_GEO</code> also contains several additional optional parameters to streamline the import process.</p>
<ul>
<li>
<code>parallel</code> and <code>num_cores</code> parameters enable use of multiple cores to speed up data import.</li>
<li>
<code>sample_list</code> By default <code>Read10X_GEO</code> will import all sets of files found within single directory. However, if only a subset of files is desired a vector of sample prefixes can be supplied to <code>sample_list</code>.</li>
<li>
<code>sample_names</code> By default <code>Read10X_GEO</code> names each entry in the returned list (see below) using the file name prefix. If different names are desired they can be supplied to <code>sample_names</code>.</li>
<li>Several other parameters from <code><a href="https://satijalab.org/seurat/reference/Read10X.html" class="external-link">Seurat::Read10X()</a></code>. See <code><a href="../reference/Read10X_GEO.html">?Read10X_GEO</a></code> for more details.</li>
</ul>
</div>
<div class="section level4">
<h4 id="read10x_geo-import-format">
<code>Read10X_GEO</code> Import Format<a class="anchor" aria-label="anchor" href="#read10x_geo-import-format"></a>
</h4>
<p><code>Read10X_GEO</code> will return list of matrices (single modality data) or list of list of matrices (multi-modal data).</p>
<div class="figure" style="text-align: center">
<img src="../docs/articles/assets/Read10X_GEO.png" alt="*Example outputs for GEX only (list of matrices) or multimodal (list of list of matrices) 10X-Style files downloaded from NCBI GEO*" width="49%"><img src="../docs/articles/assets/multimodal.png" alt="*Example outputs for GEX only (list of matrices) or multimodal (list of list of matrices) 10X-Style files downloaded from NCBI GEO*" width="49%"><p class="caption">
<em>Example outputs for GEX only (list of matrices) or multimodal (list of list of matrices) 10X-Style files downloaded from NCBI GEO</em>
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="import-10x-genomics-h5-formatted-files-single-directory-with-file-prefixes">Import 10X Genomics H5 Formatted Files single directory with file prefixes<a class="anchor" aria-label="anchor" href="#import-10x-genomics-h5-formatted-files-single-directory-with-file-prefixes"></a>
</h3>
<p>There is equivalent function for reading in 10X H5 formatted files <code>Read10X_h5_GEO</code>.<br><em>NOTE: If files have shared aspect to file name specify this using <code>shared_suffix</code> parameter to avoid that being incorporated into names to list entries in returned list.</em></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GEO_10X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read10X_h5_GEO.html">Read10X_h5_GEO</a></span><span class="op">(</span>data_dir <span class="op">=</span> <span class="st">"/path/to/data/"</span>, shared_suffix <span class="op">=</span> <span class="st">"filtered_feature_bc_matrix"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="import-delimited-matrices-single-directory-with-file-prefixes">Import delimited matrices single directory with file prefixes<a class="anchor" aria-label="anchor" href="#import-delimited-matrices-single-directory-with-file-prefixes"></a>
</h3>
<p>Often data is uploaded to NCBI GEO or other repositories with single file (.csv, .tsv, .txt, etc) containing all of the information.</p>
<p>For this example I will be utilizing data from Hammond et al., 2019 (<a href="https://doi.org/10.1016/j.immuni.2018.11.004" class="external-link"><em>Immunity</em></a>), which were downloaded from <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE121654" class="external-link">NCBI GEO GSE121654</a>.</p>
<p><code>Read_GEO_Delim</code> uses fread function for automatic detection of file delimiter and fast read times and then converts objects to sparse matrices to save memory</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"assets/GSE121654_RAW_Hammond/"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "GSM3442006_E14_F_B10.dge.txt.gz"   "GSM3442007_E14_M_B11.dge.txt.gz"  </span>
<span class="co">## [3] "GSM3442030_P100_male_3.dge.txt.gz" "GSM3442031_P100_male_4.dge.txt.gz"</span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read in and use file names to name the list</span>
<span class="va">GEO_Single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read_GEO_Delim.html">Read_GEO_Delim</a></span><span class="op">(</span>data_dir <span class="op">=</span> <span class="st">"assets/GSE121654_RAW_Hammond/"</span>, file_suffix <span class="op">=</span> <span class="st">".dge.txt.gz"</span><span class="op">)</span>

<span class="co"># Read in and use new sample names to name the list</span>
<span class="va">GEO_Single</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read_GEO_Delim.html">Read_GEO_Delim</a></span><span class="op">(</span>data_dir <span class="op">=</span> <span class="st">"assets/GSE121654_RAW_Hammond/"</span>, file_suffix <span class="op">=</span> <span class="st">".dge.txt.gz"</span>,
    sample_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample01"</span>, <span class="st">"sample02"</span>, <span class="st">"sample03"</span>, <span class="st">"sample04"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="../docs/articles/assets/delim_default.png" alt="*Example outputs with default naming based on file name or providing `sample_names` parameter.*" width="49%"><img src="../docs/articles/assets/renamed.png" alt="*Example outputs with default naming based on file name or providing `sample_names` parameter.*" width="49%"><p class="caption">
<em>Example outputs with default naming based on file name or providing <code>sample_names</code> parameter.</em>
</p>
</div>
<div class="section level4">
<h4 id="read_geo_delim-additional-parameters">
<code>Read_GEO_Delim</code> additional parameters<a class="anchor" aria-label="anchor" href="#read_geo_delim-additional-parameters"></a>
</h4>
<p>See manual entry for more info <a href="LINK">LINK</a></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="import-data-from-mutliple-directories">Import Data from Mutliple Directories<a class="anchor" aria-label="anchor" href="#import-data-from-mutliple-directories"></a>
</h2>
<p>In addition to those functions for single directories, scCustomize contains functions for when files are contained in multiple sub-directories within shared parent directory.<br><em>NOTE: These functions all assume that each sub-directory contains one sample and that sub-directory structure is identical between all samples.</em></p>
<div class="section level3">
<h3 id="import-10x-genomics-tsv-mtx">Import 10X Genomics (tsv, mtx)<a class="anchor" aria-label="anchor" href="#import-10x-genomics-tsv-mtx"></a>
</h3>
<p>Take an abbreviated example directory found below styled as output from Cell Ranger <code>count</code></p>
<pre><code>Parent_Directory
├── sample_01
│   └── outs
│       └── filtered_feature_bc_matrix
│           └── feature.tsv.gz
│           └── barcodes.tsv.gz
│           └── matrix.mtx.gz
└── sample_02
    └── outs
        └── filtered_feature_bc_matrix
            └── feature.tsv.gz
            └── barcodes.tsv.gz
            └── matrix.mtx.gz</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># In this case we can use default_10X = TRUE to tell function where to find the matrix files</span>
<span class="va">multi_10x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read10X_Multi_Directory.html">Read10X_Multi_Directory</a></span><span class="op">(</span>base_path <span class="op">=</span> <span class="st">"Parent_Directory/"</span>, default_10X <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="section level4">
<h4 id="path-inside-sub-directories">Path Inside Sub-Directories<a class="anchor" aria-label="anchor" href="#path-inside-sub-directories"></a>
</h4>
<p>In order to properly import the data <code>Read10X_Multi_Directory</code> needs to know how to navigate the sub-directory structure.</p>
<ul>
<li>The parameter <code>default_10X</code> tells the function that the directory structure matches the standardized output from Cell Ranger (see above).</li>
<li>However, it can also accept any unique sub-directory structure using the <code>secondary_path</code> parameter as long as structure is the same for all samples (see below).</li>
</ul>
<p>For instance:</p>
<pre><code>Parent_Directory
├── sample_01
│   └── gex_matrices
│       └── feature.tsv.gz
│       └── barcodes.tsv.gz
│       └── matrix.mtx.gz
└── sample_02
    └── gex_matrices
        └── feature.tsv.gz
        └── barcodes.tsv.gz
        └── matrix.mtx.gz</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># In this case we can use default_10X = FALSE to tell function where to find the matrix files</span>
<span class="va">multi_10x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read10X_Multi_Directory.html">Read10X_Multi_Directory</a></span><span class="op">(</span>base_path <span class="op">=</span> <span class="st">"Parent_Directory"</span>, default_10X <span class="op">=</span> <span class="cn">FALSE</span>, secondary_path <span class="op">=</span> <span class="st">"gex_matrices"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="optional-parameters">Optional Parameters<a class="anchor" aria-label="anchor" href="#optional-parameters"></a>
</h4>
<p><code>Read10X_Multi_Directory</code> also contains several additional parameters.</p>
<ul>
<li>
<code>parallel</code> and <code>num_cores</code> to use multiple core processing.</li>
<li>
<code>sample_list</code> By default <code>Read10X_Multi_Directory</code> will read in all sub-directories present in parent directory. However a subset can be specified by passing a vector of sample directory names.</li>
<li>
<code>sample_names</code> As with other functions by default <code>Read10X_Multi_Directory</code> will use the sub-directory names within parent directory to name the output list entries. Alternate names for the list entries can be provided here if desired. These names will also be used to add cell prefixes if <code>merge = TRUE</code> (see below).<br>
</li>
<li>
<code>merge</code> logical (default FALSE). Whether to combine all samples into single sparse matrix and using <code>sample_names</code> to provide sample prefixes.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="import-10x-genomics-h5-outputs">Import 10X Genomics (H5 Outputs)<a class="anchor" aria-label="anchor" href="#import-10x-genomics-h5-outputs"></a>
</h3>
<p>scCustomize contains function: <code>Read10X_h5_Multi_Directory</code> can be used to read 10X Genomics H5 files similarly to <code>Read10X_Multi_Directory</code></p>
<div class="section level4">
<h4 id="cell-bender-outputs">Cell Bender Outputs<a class="anchor" aria-label="anchor" href="#cell-bender-outputs"></a>
</h4>
<p>Importantly <code>Read10X_h5_Multi_Directory</code> has also been modified with optional parameters to support the files and format output by Cell Bender.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cell_bender</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Read10X_h5_Multi_Directory.html">Read10X_h5_Multi_Directory</a></span><span class="op">(</span>base_path <span class="op">=</span> <span class="st">"cellbender_results/"</span>, h5_filename <span class="op">=</span> <span class="st">"_out_filtered.h5"</span>,
    cell_bender <span class="op">=</span> <span class="cn">TRUE</span>, default_10X <span class="op">=</span> <span class="cn">FALSE</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, num_cores <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="merging-sparse-matrices">Merging Sparse Matrices<a class="anchor" aria-label="anchor" href="#merging-sparse-matrices"></a>
</h2>
<p>Rather than creating and merging Seurat objects it can sometimes be advantageous to simply combine the sparse matrices before creating Seurat object.</p>
<div class="section level3">
<h3 id="basic-use">Basic Use<a class="anchor" aria-label="anchor" href="#basic-use"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">GEO_Single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mat1</span>, <span class="va">mat2</span>, <span class="va">mat3</span><span class="op">)</span>

<span class="va">GEO_Merged</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Merge_Sparse_Data_All.html">Merge_Sparse_Data_All</a></span><span class="op">(</span>matrix_list <span class="op">=</span> <span class="va">GEO_Single</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="../docs/articles/assets/geo_merged.png" alt="*Progress bar outputs in `Merge_Sparse_Data_All` function through scCustomize.*" width="98%"><p class="caption">
<em>Progress bar outputs in <code>Merge_Sparse_Data_All</code> function through scCustomize.</em>
</p>
</div>
</div>
<div class="section level3">
<h3 id="add-barcode-prefixsuffix">Add Barcode Prefix/Suffix<a class="anchor" aria-label="anchor" href="#add-barcode-prefixsuffix"></a>
</h3>
<p><code>Merge_Sparse_Data_All</code> contains a number of optional parameters to control modification to the cell barcodes.<br><em>NOTE: If any of the barcodes in the input matrix list overlap and no prefixes/suffixes are provided the function will error.</em></p>
<ul>
<li>Users can provide a vector of either prefixes or suffixes to<code>add_cell_ids</code> to ensure barcodes are unique (and make the import to Seurat smoother with samples already labeled).<br>
</li>
<li>By default ids are added as barcode prefixes but can be added as suffixes by setting <code>prefix = FALSE</code>.<br>
</li>
<li>The prefix/suffix delimiter is “_” by default but can be changed using <code>cell_id_delimiter</code> parameter.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="merge-list-of-seurat-objects">Merge List of Seurat Objects<a class="anchor" aria-label="anchor" href="#merge-list-of-seurat-objects"></a>
</h2>
<p>To easily merge many Seurat objects contained in a list scCustomize contains simple function.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge a list of compatible Seurat objects of any length and add cell prefixes if desired</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Seurat_Merged <span class="ot">&lt;-</span> <span class="fu">Merge_Seurat_List</span>(<span class="at">list_seurat =</span> list_of_objects, <span class="at">add.cell.ids =</span> (<span class="fu">c</span>(<span class="st">"cell"</span>, <span class="st">"prefixes"</span> <span class="st">"to"</span>, <span class="st">"add"</span>)))</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="write-10x-genomics-formatted-h5-file-from-non-h5-input">Write 10X Genomics Formatted H5 file from non-H5 input<a class="anchor" aria-label="anchor" href="#write-10x-genomics-formatted-h5-file-from-non-h5-input"></a>
</h2>
<p><code>Create_10X_H5</code> provides convenient wrapper around <code>write10xCounts</code> from DropletUtils package. Output can then be easily read in using <code><a href="https://satijalab.org/seurat/reference/Read10X_h5.html" class="external-link">Seurat::Read10X_h5()</a></code> or <code>liger::createLiger</code> (which assumes H5 file is formatted as if from Cell Ranger).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Provide file path and specify type of files as either cell ranger triplicate files, matrix,</span>
<span class="co"># or data.frame</span>
<span class="fu"><a href="../reference/Create_10X_H5.html">Create_10X_H5</a></span><span class="op">(</span>raw_data_file_path <span class="op">=</span> <span class="st">"/path/matrix.mtx"</span>, source_type <span class="op">=</span> <span class="st">"Matrix"</span>, save_file_path <span class="op">=</span> <span class="st">"/path/"</span>,
    save_name <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Samuel Marsh.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
